<!DOCTYPE html>

{% load static %}

<html>
<head>
	<meta charset="UTF-8" name="viewport" content="width=device-width, initial-scale=1">
	
	<title>Machado de Assis</title>

	<link href='//fonts.googleapis.com/css?family=Inknut Antiqua' rel='stylesheet'>

	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>

	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

	<!-- <link rel="stylesheet" type="text/css" href="{% static 'machado/bootstrap-3.3.7/dist/css/bootstrap.min.css' %}"> -->

	<script>
		
		function submeterSugestao () {
			$("#form-corrigir-busca").submit();
		}

		function filtrarResultados() {
			$("#form-filtrar-resultados").submit();
		}	

	</script>

	
	<link rel="stylesheet" type="text/css" href="{% static 'machado/style.css' %}">

</head>
<body>
	<nav class="navbar navbar-default">
		<div class="container">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse-1">
					<span class="sr-only">Toggle navigation</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="{% url 'index' %}"><span>Machado</span></a>
			</div>

			<div class="collapse navbar-collapse" id="navbar-collapse-1">
				<ul class="nav navbar-nav">
					<li>
						<a href="{% url 'index' %}"> INÍCIO </a>
					</li>
					
					<li class="active">
						<a href="{% url 'obraCompleta' %}"> OBRA COMPLETA </a>
					</li>
					
					<li class="dropdown">
						<a class="dropdown-toggle" data-toggle="dropdown" href="#">GÊNEROS <span class="caret"></span></a>
						{% if generos %}
						<ul class="dropdown-menu">
							{% for genero in generos %}
							<li>
								<a href="{% url 'detalharGenero' genero.id %}">{{ genero }}</a>
							</li>
							{% endfor %}
						</ul>
						{% else %}
						<p> Não há gêneros cadastrados. </p>
						{% endif %}
					</li>
				</ul>
				<form class="navbar-form navbar-right" action="{% url 'resultadosBusca' %}" method="get">
					<div class="input-group">
						<input type="text" class="form-control" size=30 name="entrada" placeholder="Pesquisar">
					</div>
				</form>
			</div>
		</div>
	</nav>

	<div class="jumbotron text-left">
		<div class="container">
			<h1 class="titulo">Obra Completa</h1>
			<p class="subtitulo">Aqui você encontra todas as obras do autor.</p>
		</div>
	</div>

	<div class="container">
		<div class="row">
			<div class="col-sm-8 col-resultados">
				
				{% if obras %}

				<div class="panel-group">
					{% for obra in obras %}
					<div class="panel panel-default">
						<div class="panel-header">
							<div>
								{{ obra }}
							</div>
							<h5>{{ obra.genero }}, {{ obra.ano }}</h5>
						</div>
						<div class="panel-body">
							{% if obra.subtitulo_set.all %}
								<h5>Contém:</h5>
								<div>
									<ul class="subtitulos">
										{% for subtitulo in obra.subtitulo_set.all %}
											<li>{{ subtitulo }}</li>
										{% endfor %}
									</ul>
								</div>
							{% endif %}
						</div>
					</div>
					{% endfor %}
				</div>
				
				{% else %}
				
				<p> 0 resultados encontrados. </p>
				
				{% endif %}

				<div class="pagination">
					{% if obras.has_other_pages %}
						<ul class="pagination">
							{% if obras.has_previous %}
								<li><a href="?page={{ obras.previous_page_number }}">&laquo;</a></li>
							{% else %}
								<li class="disabled"><span>&laquo;</span></li>
							{% endif %}

							{% for i in obras.paginator.page_range %}
								{% if obras.number == i %}
									<li class="active"><span>{{ i }} <span class="sr-only">(current)</span></span></li>
								{% else %}
									<li><a href="?page={{ i }}">{{ i }}</a></li>
								{% endif %}
							{% endfor %}

							{% if obras.has_next %}
								<li><a href="?page={{ obras.next_page_number }}">&raquo;</a></li>
							{% else %}
								<li class="disabled"><span>&raquo;</span></li>
							{% endif %}
						</ul>
					{% endif %}
				</div>
			</div>
			
			<div class="col-sm-4 col-filtro">
				<form id="form-filtrar-resultados" action="{% url 'filtrarObraCompleta' %}" method="post">
					<div>
						<p class="titulo-filtro" style="">Gênero:</p>
						{% csrf_token %}
						{% for genero in generos %}
						<div class="form-group checkbox">							
							{% if genero.id in request.session.checked_generos %}
								<input type="checkbox" id="check-genero-{{genero.id}}" name="genero" value={{ genero.id }} onclick="filtrarResultados()" checked>
								<label for="check-genero-{{genero.id}}">{{ genero }}</label>
							{% else %}
								<input type="checkbox" id="check-genero-{{genero.id}}" name="genero" value={{ genero.id }} onclick="filtrarResultados()">
								<label for="check-genero-{{genero.id}}">{{ genero }}</label>
							{% endif %}
						</div>
						{% endfor %}						
					</div>
					
					<div>
						<p class="titulo-filtro">Ordenar por:</p>
						<div class="form-group radio">
							{% if "titulo" in request.session.checked_ordenar %}
								<input type="radio" id="radio-titulo" name="ordenar" value="titulo" onclick="filtrarResultados()" checked>
								<label for="radio-titulo">Titulo</label>
							{% else %}
								<input type="radio" id="radio-titulo" name="ordenar" value="titulo" onclick="filtrarResultados()">
								<label for="radio-titulo">Titulo</label>
							{% endif %}
						</div>
						<div class="form-group radio">
							{% if "ano" in request.session.checked_ordenar %}
								<input type="radio" id="radio-ano-crescente" name="ordenar" value="ano" onclick="filtrarResultados()" checked>
								<label for="radio-ano-crescente">Ano (Crescente)</label>
							{% else %}
								<input type="radio" id="radio-ano-crescente" name="ordenar" value="ano" onclick="filtrarResultados()">
								<label for="radio-ano-crescente">Ano (Crescente)</label>
							{% endif %}
						</div>
						<div class="form-group radio">
							{% if "-ano" in request.session.checked_ordenar %}
								<input type="radio" id="radio-ano-decrescente" name="ordenar" value="-ano" onclick="filtrarResultados()" checked>
								<label for="radio-ano-decrescente">Ano (Decrescente)</label>
							{% else %}
								<input type="radio" id="radio-ano-decrescente" name="ordenar" value="-ano" onclick="filtrarResultados()">
								<label for="radio-ano-decrescente">Ano (Decrescente)</label>
							{% endif %}
						</div>
					</div>
				</form>
			</div>
		</div>
	</div>

	<!-- <footer class="footer">
		<div class="container">
			<p>"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."</p>
		</div>
	</footer> -->

</body>
</html>